cd "$(dirname "$(readlink -f "$0")")"

# set -x

if [ `arch` == 'aarch64' ]; then
  echo 'ERROR: SQL Server for Linux on runs on AMD64 Architecture'
  exit 1
fi

sudo yum install python2
sudo yum install compat-openssl10
echo 
echo Configure python2 as the default interpreter 
sudo alternatives --config python

sudo curl -o /etc/yum.repos.d/mssql-server.repo https://packages.microsoft.com/config/rhel/8/mssql-server-2019.repo
sudo yum install -y mssql-server

sudo curl -o /etc/yum.repos.d/msprod.repo https://packages.microsoft.com/config/rhel/8/prod.repo
sudo yum remove unixODBC-utf16 unixODBC-utf16-devel
sudo yum install -y mssql-tools unixODBC-devel
echo 'export PATH="$PATH:/opt/mssql-tools/bin"' >> ~/.bashrc
source ~/.bashrc

echo ""
echo "# now run:   ./io config sqlsvr"

exit 0


